% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/samplingmethods_pt1.R
\name{rejection_sample}
\alias{rejection_sample}
\title{General-Purpose Rejection Sampling}
\usage{
rejection_sample(
  target,
  proposal,
  proposal_gen,
  n_samples = 1,
  bounds = c(-Inf, Inf),
  M = NULL,
  max_attempts = 10000
)
}
\arguments{
\item{target}{Target density function (univariate: \verb{function(x)}, bivariate: \verb{function(c(x,y))})}

\item{proposal}{Proposal density function matching \code{target}'s dimension}

\item{proposal_gen}{Function generating proposal samples (\verb{function(n)})}

\item{n_samples}{Number of samples to generate (default: 1)}

\item{bounds}{Support bounds for target (length 2 vector for univariate, matrix with 2 columns for bivariate)}

\item{M}{Optional bound for target/proposal ratio (will calculate if NULL)}

\item{max_attempts}{Maximum sampling attempts before stopping (default: 10,000)}
}
\value{
A list containing:
\itemize{
\item \code{samples}: Matrix of accepted samples (n_samples rows Ã— dimension columns)
\item \code{acceptance_rate}: Empirical acceptance probability
\item \code{M}: Used bound value
}
}
\description{
Samples from arbitrary univariate or bivariate target distributions using rejection sampling.
}
\examples{
# Univariate example: Sampling from Gamma(3,2) using Normal(1.5,1) proposal
target <- function(x) dgamma(x, shape=3, rate=2)
proposal <- function(x) dnorm(x, mean=1.5, sd=1)
proposal_gen <- function(n) rnorm(n, mean=1.5, sd=1)

result <- rejection_sample(
  target = target,
  proposal = proposal,
  proposal_gen = proposal_gen,
  bounds = c(0, Inf),
  n_samples = 1000
)
hist(result$samples, breaks=30, main="Gamma(3,2) Samples")

# Bivariate example: Sampling from custom 2D density
target2d <- function(x) exp(-x[1]^2/2 - x[2]^2/2 - x[1]*x[2]/2)
proposal2d <- function(x) dnorm(x[1]) * dnorm(x[2])
proposal_gen2d <- function(n) matrix(rnorm(2*n), ncol=2)

result2d <- rejection_sample(
  target = target2d,
  proposal = proposal2d,
  proposal_gen = proposal_gen2d,
  bounds = matrix(c(-3,3,-3,3), ncol=2),
  n_samples = 500
)
plot(result2d$samples, pch=20, main="Bivariate Samples")
}
